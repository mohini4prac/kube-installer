---
- name: "Get TOKEN"
  command: "/usr/local/bin/kubeadm token create"
  register: TOKEN
  tags: join
- name: "Print Token"
  set_fact:
    TOKEN: "{{ TOKEN }}"
  tags: join
- name: "Get HASH"
  shell: "openssl x509 -pubkey -in /etc/kubernetes/pki/ca.crt | openssl rsa -pubin -outform der 2>/dev/null | openssl dgst -sha256 -hex | sed 's/^.* //'"
  register: HASH
  tags: join
- name: "Print Hash"
  set_fact:
    HASH: "{{ HASH }}"
  tags: join


